---
html_document:
  toc: yes
author: 'Mark Klik & Misja Mikkers '
title: "Merging data frames"
editor_options:
  chunk_output_type: console
---


# Introduction


In many cases you need to merge data from two or more data frames. In this notebook we will show you how that can be done using only a few powerful commands.

Commands that can be used for merging are:

* `merge()`
* `join()` (from package `dplyr`).
* `rbind()`  en `cbind()`.

# Packages

To merge we only need the package `dplyr` (but as usual, we will load `tidyverse`).

```{r}
library(tidyverse)
```

# Dataframes

First we construct two small `data.frame`'s. Because they are small, the effects of the different merge commands can be easily observed.

```{r}
data1 <- data.frame(
  Hospital = c("Gigant","Moloch","Mega"),
  Revenue = c(100, 95, 90),
  stringsAsFactors = FALSE
)
print(data1)

data2 <- data.frame(
  Hospital = c("Gigant","Moloch","ZBC"),
  Profit = c(10, 11, 5),
  stringsAsFactors = FALSE
)
print(data2)
```


# Merging

We can now merge the two dataframes.

# using the command `merge()`

Will start with the command `merged_dataframe <- merge(your_first_data_frame, your_second_dataframe, by = the_key)`. 

Try to do this and look at the result:

```{r}
data3 <- 
print(data3)
```

As you will probably notice: the command `merge()` only returns the hospitals that are part of both data frames.

## The `join` command of `dplyr`

We advise you to use the join commands of `dplyr`.  With these commands it's easier to control what happens during a merge.

### full_join

Try `merged_dataframe <- full_join(your_first_data_frame, your_second_dataframe, by = the_key)` and inspect the result:

```{r}
fulljoin <- 
print(fulljoin)
```

When you use `full_join()`, all data points from both dataframes will be merged. Missing values will be represented by `NA`'s .

### inner_join

Now try the command  `inner_join()` and inspect the results:

```{r}
innerjoin <- 
print(innerjoin)
```

`inner_join` is comparable to the command `merge()`.

### left-join 

Inspect the results of `left_join()` and try to see what happens if you change the order of your dataframes before merging the data.

```{r}
leftjoin <- 
print(leftjoin)
```

#### right-join

Try `right_join()` as the mirror of `left_join()` .

```{r}
rightjoin <- 
print(rightjoin)
```

### Information about missings

There are 2 special functions that tell you something about the merged data.

#### anti-join

Inspect the results of `anti_join()`

```{r}
antijoin <- 
print(antijoin)
```

The command `anti_join` returns the hospitals that are present in the first dataframe, but not in the second. When you want to know which hospitals are present in the second, but not in the first dataframe, you can just switch the order of the dataframes.

#### semi-join

The `semi_join()` command returns all hospitals present in the first and the second dataframe.

```{r}
semijoin <- 
print(semijoin)
```

## rbind en cbind

Finally, the commands `cbind()`(column bind) and `rbind()` (row bind) are usefull for adding data. Only use these commands when you'r sure about the effects. Generally, we advise you not to use these commands.

## cbind

With `cbind()` you paste the data from the second data as a new column to the first dataframe. Please: `cbind()` does not match! Which means that the order of the data is important.

To illustrate this we will first change the order of the second dataframe

```{r}
data2a <- data2 %>%
  arrange(-Profit)
print(data2a)
```

And now try to use `name_of_your_merged_dataframe <- cbind(data1, data2a)`

```{r}
column <- 
print(column)
```

## rbind

With the command `rbind()` you paste the data from the second dataframe under the data of the first dataframe. The second dataframe needs the same columns as the first dataframe. To illustrate this, we will first create some new data.

```{r}
data1a <- data.frame(
  Hospital = c("Giga"),
  Revenue = c("1000")
)
print(data1a)
```

Now try to paste the second dataframe to the first one, using `rbind()`.


```{r}
row <-
print(row)
```
